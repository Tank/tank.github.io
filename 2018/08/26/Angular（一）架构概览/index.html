<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><meta name="keywords" content="Angular,前端开发,移动开发,前端,全栈,DevOps,iOS,Android,敏捷开发,技术管理,自我管理"><title>Angular（一）架构概览 | Tank's C</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Angular（一）架构概览</h1><a id="logo" href="/.">Tank's C</a><p class="description">来啊，快活啊，反正有大把时光</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Angular（一）架构概览</h1><div class="post-meta">Aug 26, 2018<span> | </span><span class="category"><a href="/categories/Angular/">Angular</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2018/08/26/Angular（一）架构概览/" href="/2018/08/26/Angular（一）架构概览/#comments" class="ds-thread-count"></a><div class="post-content"><blockquote>
<p>由于公司项目需要，使用到了Angular，所以通过学习Angular并将相关笔记整理到博客，方便日后查阅。所有笔记内容均来自于<a href="https://angular.cn/guide" target="_blank" rel="noopener">Angular教程</a>，下面正式开始学习。  </p>
</blockquote>
<p>Angular是一个用HTML和TypeScript构建客户端应用的平台与框架，所以在学习Angular之前需要掌握一些<a href="https://www.tslang.cn/" target="_blank" rel="noopener">TypeScript</a>和<a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener">ES6</a>的语法。 </p>
<blockquote>
<p>安装</p>
</blockquote>
<ol>
<li>Angular CLI是官方提供的一站式工具，可以用来创建项目、添加文件及执行一大堆的开发任务，如测试、打包和发布等。</li>
<li>建议nodejs版本在8.x以上，而npm在5.x以上（由于国内墙的原因，建议使用yarn或cnpm来替代npm）</li>
<li>通过ng new来创建项目的时候，默认会通过npm自动安装依赖包，过程可能会很慢，所以建议加入参数–no-install来跳过，然后再通过执行yarn来安装</li>
<li>服务器成功启动会打开浏览器并访问<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">``` bash</span><br><span class="line">npm install -g @angular/cli     </span><br><span class="line">ng new my-app --no-install</span><br><span class="line">cd my-app</span><br><span class="line">yarn</span><br><span class="line">ng serve --open</span><br><span class="line"></span><br><span class="line">// 生成器</span><br><span class="line">ng generate</span><br><span class="line">-&gt; cl:class</span><br><span class="line">-&gt; c:component</span><br><span class="line">-&gt; d:directive</span><br><span class="line">-&gt; e:enum</span><br><span class="line">-&gt; m:module</span><br><span class="line">-&gt; p:pipe</span><br><span class="line">-&gt; s:servide</span><br><span class="line">// 命令可简化成：ng g c User</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>项目架构</p>
</blockquote>
<p>先通过一张官方提供的架构图来说明Angular的整体框架结构。<br><img src="https://angular.cn/generated/images/guide/architecture/overview2.png" alt="Angular架构"><br>此架构图展示了Angular的主要构造块：  </p>
<ol>
<li>模块(module)</li>
<li>组件(component)</li>
<li>模板(template)</li>
<li>元数据(metadata)</li>
<li>数据绑定(binding)</li>
<li>指令(directive)</li>
<li>服务(service)</li>
<li>依赖注入(injection)</li>
</ol>
<p>这些构造块之间有哪些关联，下面逐一讲解。  </p>
<h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><p>模块由<em>@NgModule</em>装饰，它将各个组件和服务等关联起来，形成功能单元。每个Angular应用都有一个根模块，通常命名为<em>AppModule</em>。根模块提供了用来启动应用的引导机制，一个应用通常会包含很多功能模块。<br>默认的AppModule代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// app.module.ts</span><br><span class="line">import &#123; BrowserModule &#125; from &apos;@angular/platform-browser&apos;;</span><br><span class="line">import &#123; NgModule &#125; from &apos;@angular/core&apos;;</span><br><span class="line"></span><br><span class="line">import &#123; AppComponent &#125; from &apos;./app.component&apos;;</span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  declarations: [ AppComponent ],</span><br><span class="line">  imports: [ BrowserModule ],</span><br><span class="line">  exports: [ AppCompont ],</span><br><span class="line">  providers: [ Logger ],</span><br><span class="line">  bootstrap: [AppComponent]</span><br><span class="line">&#125;)</span><br><span class="line">export class AppModule &#123; &#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>declarations(可声明对象表)，声明本模块中拥有的视图类，包括：组件、指令和管道</li>
<li>imports(导入表)，本模块声明的组件中所需要使用到的类所在的其他模块，默认BrowserModule表示浏览器需要的模块，类似还有FormsModule, HttpModule等</li>
<li>exports(导出表)，可用于其他模板使用的组件模板</li>
<li>providers，依赖服务类，在此声明则全局可用</li>
<li>bootstrap，指定应用的主视图，只有根模块可设置此属性</li>
</ul>
<h3 id="组件、模板、元数据及数据绑定"><a href="#组件、模板、元数据及数据绑定" class="headerlink" title="组件、模板、元数据及数据绑定"></a>组件、模板、元数据及数据绑定</h3><p>普通的JS类，通过组件通过装饰器<em>@Component</em>修饰后变成组件，每个Angular应用至少有一个组件，也就是根组件，它会把组件树和页面中的DOM连接起来。其中组件的声明会包含模板和元数据，而在模板中，指令会提供程序逻辑，而数据绑定则将应用中的数据和DOM连接在一起。<br>组件示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// app.component.ts</span><br><span class="line">import &#123; Component &#125; from &apos;@angular/core&apos;;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: &apos;app-root&apos;,</span><br><span class="line">  templateUrl: &apos;./app.component.html&apos;,</span><br><span class="line">  styleUrls: [&apos;./app.component.css&apos;],</span><br><span class="line">  providers: []</span><br><span class="line">&#125;)</span><br><span class="line">export class AppComponent &#123;</span><br><span class="line">  title = &apos;myapp&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>selector，CSS选择器，一旦在模板HTML中找到这个选择器对应的标签，就创建并插入该组件的一个实例，如在项目的index.html中有<app-root></app-root>，Angular会在这个页面中插入AppComponent实例的视图</li>
<li>templateUrl，当前组件对应的模板HTML路径，如果为template则直接写HTML字符串，可以在模板中写入其他子组件的selector来进行组件内嵌</li>
<li>styleUrls，当前组件对应的CSS样式地址，如果为styles则直接写CSS字符串</li>
<li>providers，当前组件使用的注入服务</li>
<li>metadata，元数据则是在组件类中定义的一些变量，可以通过@Input()，@Output()等进行装饰</li>
</ul>
<p>数据绑定主要有以下四种表现：<br><img src="https://angular.cn/generated/images/guide/architecture/databinding.png" alt="数据绑定"><br>需要注意的是数据绑定在模板及组件之间的通讯扮演了非常重要的角色，在父组件和子组件之间的通讯也同样重要。<br><img src="https://angular.cn/generated/images/guide/architecture/parent-child-binding.png" alt="数据通讯"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// app.component.html</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;h1&gt;</span><br><span class="line">    Welcome to &#123;&#123; showTitle &#125;&#125;!</span><br><span class="line">  &lt;/h1&gt;</span><br><span class="line">  &lt;ul *ngIf=&quot;datas&quot;&gt;</span><br><span class="line">    &lt;li *ngFor=&quot;let data of datas&quot; (click)=&quot;selectData(data)&quot;&gt;&#123;&#123;data&#125;&#125;&lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">  &lt;input [(ngModel)]=&quot;name&quot;&gt;</span><br><span class="line">  &lt;app-detail [id]=&quot;detailId&quot;&gt;&lt;/app-detail&gt;</span><br><span class="line">&lt;div&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>表示一个插值表达式，为单向绑定，方向是组件-&gt;模板(由于插值表达式跟hexo冲突，所以在这里没法显示，参考上面的welcome to)</li>
<li>[id]表示一个属性绑定，在这里表示父组件传递id给子组件，方向是组件-&gt;模板</li>
<li>(click)表示事件绑定，相关事件在组件中的实现，方向是模板-&gt;组件</li>
<li>[(ngModel)]表示双向绑定，方向是组件<->模板</-></li>
<li>表示管道，管道是简单处理模板显示逻辑，通过一个<em>@Pipe</em>的装饰器来定义，使用时通过管道操作符|来进行操作，多个管道通过多个|进行分隔(同样是跟hexo的冲突)</li>
</ul>
<h3 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h3><p>指令是通过<em>@Directive</em>装饰的类，从技术角度来说，组件也是指令的一种。指令的元数据把指令类和一个selector关联起来，在模板中，指令通常作为属性出现在元素标签上，可能仅作为名字，也可能作为赋值目标或绑定目标出现，指令分为两种：</p>
<ul>
<li>结构型指令，通过添加、移除或替换DOM元素来修改布局，如上面例子中的*ngIf和*ngFor</li>
<li>属性型指令，用来修改现有元素的外观和行为，在模板中，看起来跟普通HTML属性一样，如上面例子中的<em>[(ngModel)]</em>，Angular还提供了很多预定义指令，如<em>ngSwitch, ngStyle, ngClass</em>等</li>
</ul>
<h3 id="服务和依赖注入"><a href="#服务和依赖注入" class="headerlink" title="服务和依赖注入"></a>服务和依赖注入</h3><p>为提高模块性和复用性，Angular把组件和服务区分开。组件的工作最好只管用户体验，提供数据绑定需要的属性和方法，组件不应该从服务器中获取数据、验证用户输入或从控制台中写日志等。而要把这些任务委托给各种服务，并通过注入的形式来供组件使用。<br>服务类通过<em>@Injectable</em>来装饰，并通过模板或组件中的providers属性将服务作为依赖注入到客户组件中。<br>以下通过<em>ng g s data</em>生成一个服务类。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// data.service.ts</span><br><span class="line">import &#123; Injectable &#125; from &apos;@angular/core&apos;;</span><br><span class="line">import &#123; LoggerService &#125; from &apos;./logger.service&apos;;</span><br><span class="line"></span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  providedIn: &apos;root&apos;</span><br><span class="line">&#125;)</span><br><span class="line">export class DataService &#123;</span><br><span class="line"></span><br><span class="line">  constructor(private logger: LoggerService) &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>服务类也可以通过注入其他服务来复用其相关功能，如日志类，通过在构造函数中声明实例则可以直接在数据服务类里使用日志的功能 </li>
<li>providedIn把当前服务注册到根注入器中</li>
<li>在NgModule中注册服务时，表示整个模块下的所有组件均可用该服务，而在组件中注册服务时，则表示只能在该组件及其子组件中能使用该服务</li>
</ul>
<h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><p>由于Angular是一个单页面应用，有时需要在不同的组件之间进行切换，这时就需要涉及到路由。它可以让定义在应用的各个不同状态和视图层次结构之间进行导航切换，它的工作模型跟现在大家熟知的浏览器导航一致：</p>
<ul>
<li>在地址栏输入URL，浏览器会导航到相应的组件</li>
<li>在页面中点击链接，浏览器会导航到相应的组件</li>
<li>在浏览器中前进后退，也会在相应的浏览历史中进行向前或向后导航</li>
</ul>
<p>路由的定义如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// ng g m app-routing --flat --module=app</span><br><span class="line">import &#123; AppComponent &#125; from &apos;./app.component&apos;;</span><br><span class="line">import &#123; NgModule &#125; from &apos;@angular/core&apos;;</span><br><span class="line">import &#123; RouterModule, Routes &#125; from &apos;@angular/router&apos;;</span><br><span class="line"></span><br><span class="line">const routes: Routes = [</span><br><span class="line">  &#123; path: &apos;&apos;, component: AppComponent &#125;,</span><br><span class="line">  &#123; path: &apos;home&apos;, component: AppComponent &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  exports: [ RouterModule ],</span><br><span class="line">  imports: [ RouterModule.forRoot(routes) ],</span><br><span class="line">&#125;)</span><br><span class="line">export class AppRoutingModule &#123; &#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>声明一个路由模块并把它加入到AppModule中</li>
</ul>
<p>架构部分就差不多到这里。接下来是更具体的细节部分的学习。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="https://tankc.cn/2018/08/26/Angular（一）架构概览/" data-id="cjlaiy2bt001wq9psv36r4o0n" class="article-share-link">分享到</a><div class="tags"><a href="/tags/Angular/">Angular</a></div><div class="post-nav"><a href="/2017/01/07/Markdown-忍不住爱上这写作方式/" class="next">Markdown-忍不住爱上这写作方式</a></div><div data-thread-key="2018/08/26/Angular（一）架构概览/" data-title="Angular（一）架构概览" data-url="https://tankc.cn/2018/08/26/Angular（一）架构概览/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2018/08/26/Angular（一）架构概览/" data-title="Angular（一）架构概览" data-url="https://tankc.cn/2018/08/26/Angular（一）架构概览/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://tankc.cn"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Angular/">Angular</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂项/">杂项</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/Angular/" style="font-size: 15px;">Angular</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/08/26/Angular（一）架构概览/">Angular（一）架构概览</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/07/Markdown-忍不住爱上这写作方式/">Markdown-忍不住爱上这写作方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/04/Hexo-快速、简洁且高效的博客框架/">Hexo-快速、简洁且高效的博客框架</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Tank's C.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'frog2020'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3084737817def1a08671563b685ceaae";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>